
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Readme for Summer Irrigated Cropping Area workflow (tailored for Tasmania analysis, 24/09/2019)

    - An explanation of the output filenames are at the bottom of this readme
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


1. Run 'clip_ndvi_max.py' which clips the max NDVI geotiffs to an AOI, using
	a provided shapefile. The script requires you place all the mosaicked
	geotiffs into a single folder.
	This script has been written to work with the specific file naming structure that
	I use so it can be finicky if you're deviating from that.  You'll likely need 
	to change the first few lines of code in the 'clip_extent' function that set up the strings
	for the input and output filenames.

2. Run the notebook 'Summer_irrigated_Area.ipynb'. This does the bulk of the analysis by pulling in the 
	clipped NDVI maximum geotiff from step 1 and running the image segmentation, thresholding
	the zonal stats over the segments, and filtering by area.  

3. The results of step 2 produce files called e.g. '<AOI>_<Season+Year>_80polys10ha.shp'
	These files contain only the polygons that achieved a zonally averaged threshold of >= 0.8 NDVI
    and are larger than 10ha in size.
	Using a rainfall anomaly timeseries from BOM for the AOI, open the anomalously dry and
	very-close-to-average years in ArcGIS and merge them to form a single file (ArcGIS is
	very fast at this but QGIS and python libraries can be prohibitively slow if working over
    very large areas with manmy polygons). Call the file somethinng like '<AOI>_80mask_allDryYears_merged.shp'
	This file will later be used as a mask to filter out errors from the results generated by
	step 2.
	
4. Using a good basemap, manually curate obvious commission errors contained in the 
	'<AOI>_80mask_allDryYears_merged.shp' file.  Typically these will be plantation forests
	and highlands grasslands in regions closer to the coast. There are also 'tractor tread'
    artefacts from geometric errors in the LS5 satellite data that need to be deleted.

5. Run 'mask_results.py' which applies the curated mask from step 4 over the '...multithreshold.tif' output
	from step 2.  The results from this script have a suffix called '_Irrigated_<mask>.shp'. These are your
	final results from the analysis.
	
	
6. Use the 'inspect_resuts.ipynb' and 'dateFirstObservedetc.ipynb' notebooks to generate plots of your results.

	
!!!!!!!!!!!!!!!!!!!!!!!!!!
------Filename Index------
!!!!!!!!!!!!!!!1!!!!!!!!!!

<AOI>_<Season_Year>_sheperdSEG.kea
    This file contains the results of the image segmentation algorithm provided with the RSGISlib library.
    It is the output of applying image segmentation over the seasonal composite of Maximum NDVI.

<AOI>_<Season_Year>_ClumpMean.kea
    This file is the same as the sheperdSEG file but the segments have the zonal mean NDVI as an
    attribute. This file is the input to creating the multithreshold.tif

<AOI>_<Season_Year>_multithreshold.tif
    This raster contains the segments that have a zonal mean NDVI greater than the various thresholds.
    e.g. 0.7 > NDVI > 0.65 then raster = 65; 0.8 > NDVI > 0.75 then raster = 75, etc.

<AOI>_<Season_Year>_multithreshold_masked.tif
    This raster is the results of applying the 'allDryYears' mask over the multithreshold.tif

<AOI>_<Season_Year>_80polys_10ha.shp
    Contains polygons that achieve a segement zonal average >=0.8 NDVI and are > 10ha < 5000ha.
    These are the polygons used to create the 'allDryYears' mask
    
<AOI>_<Season_Year>_Irrigated_<mask>.shp
    These are the final results of the analysis and are generated by applying the 'allDryYears' mask
    over the multithreshold.tif. The polygons contain two attributes, the zonal mean NDVI and the area in m2
    

    

    

    





